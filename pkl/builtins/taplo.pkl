import "../Config.pkl"

taplo = new Config.Step {
  category = "Data Formats"
  description = "TOML linter"
  glob = "**/*.toml"
  check = "taplo lint {{ files }}"
  tests {
    ["check bad file"] {
      run = "check"
      write { ["{{tmp}}/file.toml"] = "[table]\nkey = 0\nkey = 1\n" }
      files = List("{{tmp}}/file.toml")
      expect { code = 1 }
    }
    ["check good file"] {
      run = "check"
      write { ["{{tmp}}/file.toml"] = "[table]\nkey = 0\n" }
      files = List("{{tmp}}/file.toml")
      expect { code = 0 }
    }
    ["doesnt error on formattting"] {
      run = "check"
      write { ["{{tmp}}/file.toml"] = "[table]\nkey   =   0\n" }
      files = List("{{tmp}}/file.toml")
      expect { code = 0 }
    }
  }
}
